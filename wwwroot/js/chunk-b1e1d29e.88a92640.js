(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1e1d29e"],{"3ad6":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Navbar"),i("div",{staticClass:"bg-secondary"},[i("div",{staticClass:"container py-5"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-lg-9 col-12"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"row justify-content-between"},[i("div",{staticClass:"col-6 "},[i("h3",{staticClass:"card-title"},[e._v(e._s(e.article.title))]),i("h6",{staticClass:"card-subtitle mb-2 text-success"},[e._v("作者: "+e._s(e.article.userName))]),i("p",{staticClass:"card-date text-muted"},[e._v(" "+e._s(e.article.createDate.replace(/-/g,"/").replace("T"," ").replace(/\.\d+/,""))+" ")])]),i("div",{staticClass:"col-3 d-flex justify-content-end align-items-center"},[e.article.userId===e.reply.userId?i("a",{staticClass:"title-btn rounded-circle",on:{click:function(t){e.$bvModal.show("edit"),e.saveOrginArticle()}}},[i("font-awesome-icon",{attrs:{icon:"pen",size:"lg"}})],1):e._e(),e.article.userId===e.reply.userId?i("a",{staticClass:"title-btn rounded-circle",on:{click:e.deleteArticle}},[i("font-awesome-icon",{attrs:{icon:"trash",size:"lg"}})],1):e._e()])]),i("hr"),i("div",{staticClass:"article-content"},[i("div",{domProps:{innerHTML:e._s(e.article.description)}}),i("div",{staticClass:"col-6 d-flex align-items-center p-0"},[i("div",{staticClass:"mr-2 d-flex align-items-center"},[i("a",{staticClass:"rounded-circle title-btn",class:e.templike.articleLike?"active":"",attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.likeArticle(t)}}},[i("font-awesome-icon",{attrs:{icon:"thumbs-up",size:"lg"}})],1),i("span",{staticClass:"text-secondary px-2"},[e._v(e._s(e.article.like))])]),i("div",{staticClass:"mr-2 d-flex align-items-center"},[i("a",{staticClass:"rounded-circle title-btn",class:e.templike.articleDislike?"active":"",attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.dislikeArticle(t)}}},[i("font-awesome-icon",{attrs:{icon:"thumbs-down",size:"lg"}})],1),i("span",{staticClass:"text-secondary px-2"},[e._v(e._s(e.article.dislike))])])])])]),i("div",{staticClass:"reply-group border p-3"},[e._l(e.messageList,(function(t,s){return i("div",{key:t.messageId,staticClass:"reply-item row justify-content-between"},[i("div",{staticClass:"col-12 col-md-10 d-flex"},[i("a",{staticClass:"user-img"},[i("font-awesome-icon",{attrs:{icon:"user",size:"lg"}})],1),i("div",{staticClass:"reply-content"},[i("a",{staticClass:"replay-user mr-2 d-inline-block"},[e._v(e._s(t.userName))]),i("span",{staticClass:"card-date text-muted"},[e._v(e._s(t.createdDate.replace(/-/g,"/").replace("T"," ").replace(/\.\d+/,"")))]),i("p",[e._v(e._s(t.context))])])]),i("div",{staticClass:"col-12 col-md-2 d-flex align-items-center"},[i("a",{staticClass:"title-btn msg-btn border-0 rounded-circle",class:e.templike.messagelikeList[s].like?"active":"",attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.likeMessage(s)}}},[i("font-awesome-icon",{attrs:{icon:"thumbs-up",size:"sm"}})],1),i("span",{staticClass:"px-2"},[e._v(e._s(t.likeNumber))]),i("a",{staticClass:"title-btn msg-btn border-0 rounded-circle",class:e.templike.messagelikeList[s].dislike?"active":"",attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.dislikeMessage(s)}}},[i("font-awesome-icon",{attrs:{icon:"thumbs-down",size:"sm"}})],1),i("span",{staticClass:"px-2"},[e._v(e._s(t.disLikeNumber))])])])})),i("div",{staticClass:"reply-item border-0"},[i("div",{staticClass:"input-group"},[i("a",{staticClass:"user-img text-secondary bg-white"},[i("font-awesome-icon",{attrs:{icon:"user",size:"lg"}})],1),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reply.context,expression:"reply.context"}],staticClass:"form-control h-100",attrs:{placeholder:"留個言吧~"},domProps:{value:e.reply.context},on:{input:function(t){t.target.composing||e.$set(e.reply,"context",t.target.value)}}}),i("button",{staticClass:"btn btn-secondary h-100",on:{click:function(t){return t.preventDefault(),e.postMessage(t)}}},[e._v("送出")])])])],2)])])])])]),i("b-modal",{attrs:{id:"edit",title:"編輯文章",size:"lg",centered:"","ok-title":"儲存","cancel-title":"取消"},on:{ok:e.editArticle,cancel:e.cancelEdit}},[i("vue-editor",{attrs:{id:"editor",useCustomImageHandler:"",customModules:e.customModulesForEditor,editorOptions:e.editorSettings},on:{"image-added":e.handleImageAdded},model:{value:e.article.description,callback:function(t){e.$set(e.article,"description",t)},expression:"article.description"}})],1)],1)},a=[],r=(i("a4d3"),i("e01a"),i("4160"),i("9911"),i("159b"),i("96cf"),i("1da1")),n=i("7106"),l=i("5873"),c=i("2a19"),o=i("9e07"),d=i.n(o),u=i("bc3a"),p=i.n(u),m={components:{Navbar:n["default"],VueEditor:l["a"]},data:function(){return{customModulesForEditor:[{alias:"imageDrop",module:c["a"]},{alias:"imageResize",module:d.a}],editorSettings:{modules:{imageDrop:!0,imageResize:{}}},article:{postId:"",userId:"",title:"",userName:"",createDate:"",like:0,dislike:0,description:"",state:!1},tempDescription:"",messageList:[],reply:{postId:"",context:"",userId:""},templike:{articleLike:!1,articleDislike:!1,messageLike:!1,messageDisLike:!1,messagelikeList:[]}}},methods:{handleImageAdded:function(e,t,i){var s="3d78cf6e67ed6af",a=new FormData;a.append("image",e),p()({url:"https://api.imgur.com/3/image",method:"POST",headers:{Authorization:"Client-ID "+s},data:a}).then((function(e){var s=e.data.data.link;t.insertEmbed(i,"image",s)})).catch((function(e){console.log(e)}))},getUserInfo:function(){var e=this,t="/api/Users/getSingleMember";e.$axios.get(t).then((function(t){e.reply.userId=t.data.userId})).catch((function(e){console.log(e)}))},getArticle:function(){var e=this,t="/api/Post/getSingle/"+e.$route.params.id;e.$axios.get(t).then((function(t){console.log(t.data),e.article={postId:t.data.postId,userId:t.data.userId,title:t.data.title,userName:t.data.userName,createDate:t.data.createdDate,description:t.data.description,like:t.data.likeNumber,dislike:t.data.disLikeNumber,state:t.data.state},e.reply.postId=t.data.postId}))},saveOrginArticle:function(){var e=this;e.tempDescription=e.article.description},cancelEdit:function(){var e=this;e.article.description=e.tempDescription},getMessages:function(){var e=this,t="/api/RMessage/GetAllMessages/"+e.$route.params.id;e.$axios.get(t).then((function(t){t.data.issuccessful&&(e.messageList=t.data.data,t.data.data.forEach((function(t){var i={postId:t.postId,like:!1,dislike:!1};e.templike.messagelikeList.push(i)})))}))},editArticle:function(){var e=this,t="/api/Post/Edit",i={postId:e.article.postId,title:e.article.title,description:e.article.description,state:!0};e.$axios.post(t,i).then((function(t){console.log(t),200===t.status&&e.$swal({position:"top-end",title:"編輯成功",icon:"success",showConfirmButton:!1,timer:1e3})})).catch((function(t){console.log(t),e.$swal({position:"top-end",title:"編輯失敗"+t,icon:"error",showConfirmButton:!1,timer:1e3})}))},deleteArticle:function(){var e=this,t="/api/Post/Delete",i={postId:e.article.postId};e.$swal({title:"刪除文章",text:"你確定要刪除嗎",type:"question",showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then((function(s){s.value&&e.$axios.post(t,i).then((function(t){console.log(t),200===t.status&&(e.$swal({position:"top-end",title:"刪除成功",icon:"success",showConfirmButton:!1,timer:1500}),e.$router.push("/"))})).catch((function(t){e.$swal("失敗",t)}))}))},postMessage:function(){var e=this,t="/api/RMessage/CreateMessage";e.$axios.post(t,e.reply).then((function(t){console.log(t),t.data.issuccessful&&(e.reply.context="",e.getMessages())})).catch((function(){alert("請先登入再留言")}))},likeArticle:function(){var e=this;e.templike.articleLike?(e.templike.articleLike=!1,e.article.like-=1):(e.templike.articleLike=!0,e.article.like+=1,e.templike.articleDislike&&(e.templike.articleDislike=!1,e.article.dislike-=1))},dislikeArticle:function(){var e=this;e.templike.articleDislike?(e.templike.articleDislike=!1,e.article.dislike-=1):(e.templike.articleDislike=!0,e.article.dislike+=1,e.templike.articleLike&&(e.templike.articleLike=!1,e.article.like-=1))},likeMessage:function(e){var t=this;t.templike.messagelikeList[e].like?(t.templike.messagelikeList[e].like=!1,t.messageList[e].likeNumber-=1):(t.templike.messagelikeList[e].like=!0,t.messageList[e].likeNumber+=1,t.templike.messagelikeList[e].dislike&&(t.templike.messagelikeList[e].dislike=!1,t.messageList[e].disLikeNumber-=1))},dislikeMessage:function(e){var t=this;t.templike.messagelikeList[e].dislike?(t.templike.messagelikeList[e].dislike=!1,t.messageList[e].disLikeNumber-=1):(t.templike.messagelikeList[e].dislike=!0,t.messageList[e].disLikeNumber+=1,t.templike.messagelikeList[e].like&&(t.templike.messagelikeList[e].like=!1,t.messageList[e].likeNumber-=1))},saveLikeData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var i,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e,s={url:"/api/LikeAndDisLike/PostLikeAndDislike",data:{postId:i.article.postId,likeNumber:i.article.like,disLikeNumber:i.article.dislike},post:function(){return i.$axios.put(s.url,s.data).then((function(e){console.log(e)})).catch((function(e){return console.log(e)}))}},a={url:"/api/LikeAndDisLike/MsgLikeAndDislike",data:[],post:function(){return a.data.forEach((function(e){console.log(e),i.$axios.post(a.url,e).then((function(e){console.log(e)})).catch((function(e){return console.log(e)}))}))}},i.messageList.forEach((function(e){var t={messageId:e.messageId,likeNumber:e.likeNumber,disLikeNumber:e.disLikeNumber};a.data.push(t)})),t.next=6,s.post();case 6:return t.next=8,a.post();case 8:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getArticle();case 2:return t.next=4,e.getMessages();case 4:return t.next=6,e.getUserInfo();case 6:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.saveLikeData()}},k=m,g=(i("ba53"),i("2877")),f=Object(g["a"])(k,s,a,!1,null,"777db876",null);t["default"]=f.exports},ba53:function(e,t,i){"use strict";var s=i("c6ff"),a=i.n(s);a.a},c6ff:function(e,t,i){},e01a:function(e,t,i){"use strict";var s=i("23e7"),a=i("83ab"),r=i("da84"),n=i("5135"),l=i("861d"),c=i("9bf2").f,o=i("e893"),d=r.Symbol;if(a&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new d(e):void 0===e?d():d(e);return""===e&&(u[t]=!0),t};o(p,d);var m=p.prototype=d.prototype;m.constructor=p;var k=m.toString,g="Symbol(test)"==String(d("test")),f=/^Symbol\((.*)\)[^)]+$/;c(m,"description",{configurable:!0,get:function(){var e=l(this)?this.valueOf():this,t=k.call(e);if(n(u,e))return"";var i=g?t.slice(7,-1):t.replace(f,"$1");return""===i?void 0:i}}),s({global:!0,forced:!0},{Symbol:p})}}}]);
//# sourceMappingURL=chunk-b1e1d29e.88a92640.js.map